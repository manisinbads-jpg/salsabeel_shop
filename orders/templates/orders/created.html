{% extends "products/base.html" %}
{% load static %}
{% load humanize %}
{% block content %}

<style>
.order-box {
    max-width: 900px;
    margin: 30px auto;
    background: #fff;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.order-box h2 {
    text-align: center;
    color: #2e7d32;
    margin-bottom: 10px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}

th, td {
    padding: 12px;
    border-bottom: 1px solid #ddd;
    text-align: left;
}

th {
    background: #f5f5f5;
}

.product-img {
    width: 70px;
    height: auto;
    border-radius: 6px;
}

.total {
    text-align: right;
    font-size: 20px;
    margin-top: 15px;
    font-weight: bold;
}
</style>

<div class="order-box">
    <h2>âœ… Order Successful</h2>
    <p class="text-muted text-center">
        Order Number: <strong>#{{ order.id }}</strong>
    </p>
    <p class="text-center">Thank you for your order.</p>

    <table>
        <tr>
            <th>Product</th>
            <th>Image</th>
            <th>Qty</th>
            <th>Price (TZS)</th>
            <th>Total (TZS)</th>
        </tr>

        {% for item in order.items.all %}
        <tr>
            <td>{{ item.product.name }}</td>
            <td>
                {% if item.product.image %}
                    <img src="{{ item.product.image.url }}" class="product-img">
                {% else %}
                    No image
                {% endif %}
            </td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.price|intcomma }}</td>
            <td>{{ item.get_cost|intcomma }}</td>
        </tr>
        {% endfor %}
    </table>

    <div class="total">
        GRAND TOTAL: TZS {{ order.get_total_cost|intcomma }}
    </div>
    <div class="text-center mt-3">
    <a href="https://wa.me/255794296633?text={{ whatsapp_message }}"
       class="btn btn-success"
       target="_blank">
        ðŸ“² Send Order via WhatsApp
    </a>
</div>

    <p class="text-center mt-3">
        Payment Method: <strong>{{ order.get_payment_method_display }}</strong>
    </p>

    <div class="text-center mt-4">
        <a href="{% url 'products:product_list' %}" class="btn btn-primary">
            Continue Shopping
        </a>
    </div>
</div>

{% endblock %}
